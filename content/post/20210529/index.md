---
draft: false
title: "Network Programming の基礎を学んだ"
date: 2021-05-29T00:08:15+09:00
tags: ["Network", "Ethernet", "ARP", "IP", "ICMP", "TCP", "UDP"]
ogimage: "img/images/20210529.png"
---

## 概要

- こんにちは！ゴールデンウィーク明けから [基礎からわかるTCP/IP ネットワーク実験プログラミング（第2版）](https://www.ohmsha.co.jp/book/9784274065842/) を読んでいました。この本は [マスタリングTCP/IP―入門編―(第6版)](https://www.amazon.co.jp/%E3%83%9E%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0TCP-IP%E2%80%95%E5%85%A5%E9%96%80%E7%B7%A8%E2%80%95-%E7%AC%AC6%E7%89%88-%E4%BA%95%E4%B8%8A-%E7%9B%B4%E4%B9%9F/dp/4274224473) の著者の一人である [村山公保先生](https://ja.wikipedia.org/wiki/%E6%9D%91%E5%B1%B1%E5%85%AC%E4%BF%9D) が書かれた本です。丁度今日に読み終えたので、なぜ読み始めたのかや何を学んだかなどの記録を残したいと思います。

## 読み始めたきっかけと目的

- この本を読もうと思ったきっかけは、システムプログラミングをしつつ、ネットワークプロトコル (Ethernet/ARP/IP/ICMP/TCP/UDP) を C 言語のプログラムレベルで理解したいと思ったからです。例えば TCP のヘッダの構造体は Ubuntu のどのパスに定義されていて、それを用いて、システムコールをどのように呼び出せば TCP のパケットを作って通信できるかなどです。大学/大学院の講義やマスタリングTCP/IP や普段の Web プログラミングを通して、基本的な通信の概念は知っていました。しかし、プロトコルをプログラムレベルでイメージできるほどは理解できていませんでした。そのため、ネットワークプロトコルの実装が C 言語のプログラムレベルでイメージできるようになることが、この本を読む目的でした。

## 学んだこと

- この本を通して学んだことを列挙します。
  - プログラムレベルでのプロトコルの解説
  - ネットワークプロトコルに必要な構造体、システムコール、ライブラリ関数の使い方とそれらの調査方法
  - socket システムコールを用いた `UDP Client/UDP Server` の実装
  - socket システムコールを用いた `TCP Client/TCP Server` の実装
  - パケットモニタリングを行い Ethernet/ARP/IP/ICMP/TCP/UDP の`ヘッダの解析`
  - `IP スキャン` / `TCP ポートスキャン` / `UDP ポートスキャン` の実装
  - ARP 要求パケットや ARP 応答パケットを用いた対象のホストの `ARP テーブルを書き換える攻撃手法`の実装
  - ICMP redirect を用いた対象のホストの`ルーティングテーブルを書き換える攻撃手法`の実装
  - IP ヘッダの TTL を用いた [traceroute](https://archlinux.org/packages/core/x86_64/traceroute/) コマンドのようなものを実装
  - TCP のヘッダを作成し、`SYN flood 攻撃`の実装
  - TCP のヘッダを作成し、 `ESTABLISHED な TCP のコネクションを強制的に切断する攻撃手法`の実装
  - TCP のヘッダを作成し、`TCP ジャックをする攻撃手法`の実装

- システムコールを用いた自作クライアントとサーバの実装、パケットモニタリング、攻撃手法の再現を通して、ネットワークプロトコルの構造や各レイヤーの関係性を学ぶことができました。読み応えのある非常に良い本でした。理解があやふやな箇所もあるので、期間を空けて本を読み直したいと思いました。

## 参考

- [kiso_tcp](https://github.com/haytok/NetworkProgramming/tree/main/kiso_tcp)
